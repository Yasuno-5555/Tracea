Tracea JIT: Device Compute Capability: 86
Tracea JIT: Compiling gemm_pipelined_kernel...
Tracea JIT: Generated PTX Version: .version 9.1
Tracea JIT: Patching PTX version 9.x -> 7.8 for compatibility
Tracea JIT: Successfully compiled and loaded gemm_pipelined_kernel
Tracea JIT: Cache hit for gemm_pipelined_kernel
Tracea JIT: Compiling gemm_pipelined_kernel...
Tracea JIT: Generated PTX Version: .version 9.1
Tracea JIT: Patching PTX version 9.x -> 7.8 for compatibility
[Tracea] Benchmark Suite: Initializing for A100...
[WARN] CUDA not detected in PyTorch. Running in simulation/verification mode.

--- Phase A: Peak GEMM (Performance Verification) ---
Running 4096x4096x4096 GEMM...
Size 4096x4096: 188.825 ms (0.73 TFLOPS)
Running 8192x8192x8192 GEMM...
Size 8192x8192: 0.057 ms (19188.68 TFLOPS)

--- Phase B: Fusion Showdown (Transformer MLP Pattern) ---
Running Fused 4096x4096 ...
Traceback (most recent call last):
  File "E:\Projects\Tracea\benchmarks\masterpiece_bench.py", line 120, in <module>
    bench.run_fusion_showdown(4096)
  File "E:\Projects\Tracea\benchmarks\masterpiece_bench.py", line 103, in run_fusion_showdown
    self.ctx.matmul(self.ctx.a_ptr, self.ctx.b_ptr, self.ctx.c_ptr, m, n, k, epilogue)
RuntimeError: JIT Compilation Failed: Load PTX Error: DriverError(CUDA_ERROR_ILLEGAL_ADDRESS, "an illegal memory access was encountered")

thread '<unnamed>' (5616) panicked at C:\Users\kouno\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\cudarc-0.12.1\src\driver\safe\core.rs:252:76:
called `Result::unwrap()` on an `Err` value: DriverError(CUDA_ERROR_ILLEGAL_ADDRESS, "an illegal memory access was encountered")
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace

thread '<unnamed>' (5616) panicked at C:\Users\kouno\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\cudarc-0.12.1\src\driver\safe\core.rs:252:76:
called `Result::unwrap()` on an `Err` value: DriverError(CUDA_ERROR_ILLEGAL_ADDRESS, "an illegal memory access was encountered")
stack backtrace:
   0:     0x7ffc3f4a0cf2 - PyInit_tracea
   1:     0x7ffc3f4a93ba - PyInit_tracea
   2:     0x7ffc3f497397 - PyInit_tracea
   3:     0x7ffc3f49b675 - PyInit_tracea
   4:     0x7ffc3f49cf89 - PyInit_tracea
   5:     0x7ffc3f49cd78 - PyInit_tracea
   6:     0x7ffc3f49d80b - PyInit_tracea
   7:     0x7ffc3f49d5d9 - PyInit_tracea
   8:     0x7ffc3f49b86f - PyInit_tracea
   9:     0x7ffc3f494d4e - PyInit_tracea
  10:     0x7ffc3f4b4ac1 - PyInit_tracea
  11:     0x7ffc3f4b4750 - PyInit_tracea
  12:     0x7ffc3f45fc14 - PyInit_tracea
  13:     0x7ffc3f45f48b - PyInit_tracea
  14:     0x7ffc3f45f8a2 - PyInit_tracea
  15:     0x7ffc3f45f41d - PyInit_tracea
  16:     0x7ffcc2b21030 - <unknown>
  17:     0x7ffcc2b24cb2 - is_exception_typeof
  18:     0x7ffcc2b2f0e4 - _C_specific_handler
  19:     0x7ffcc2b23f28 - is_exception_typeof
  20:     0x7ffcc2b2fa21 - _CxxFrameHandler3
  21:     0x7ffce20863af - _chkstk
  22:     0x7ffce1f2e593 - RtlUnwindEx
  23:     0x7ffcc2b2f5ae - _C_specific_handler
  24:     0x7ffcc2b22bf5 - is_exception_typeof
  25:     0x7ffcc2b2300d - is_exception_typeof
  26:     0x7ffcc2b24024 - is_exception_typeof
  27:     0x7ffcc2b2fa21 - _CxxFrameHandler3
  28:     0x7ffce208632f - _chkstk
  29:     0x7ffce1f32327 - RtlLocateExtendedFeature
  30:     0x7ffce1f2a961 - RtlRaiseException
  31:     0x7ffcdf9b804a - RaiseException
  32:     0x7ffcc2b26480 - CxxThrowException
  33:     0x7ffc3f4a11ed - PyInit_tracea
  34:     0x7ffc3f4a10c5 - PyInit_tracea
  35:     0x7ffc3f494a35 - PyInit_tracea
  36:     0x7ffc3f49d883 - PyInit_tracea
  37:     0x7ffc3f49d5d9 - PyInit_tracea
  38:     0x7ffc3f49b86f - PyInit_tracea
  39:     0x7ffc3f494d4e - PyInit_tracea
  40:     0x7ffc3f4b4ac1 - PyInit_tracea
  41:     0x7ffc3f4b4750 - PyInit_tracea
  42:     0x7ffc3f45fc14 - PyInit_tracea
  43:     0x7ffc3f45f48b - PyInit_tracea
  44:     0x7ffc3f45f8a2 - PyInit_tracea
  45:     0x7ffc3f45f326 - PyInit_tracea
  46:     0x7ffc3f45f151 - PyInit_tracea
  47:     0x7ffc3f45ea0f - PyInit_tracea
  48:     0x7ffc3f45ecd1 - PyInit_tracea
  49:     0x7ffc5f0dbc9e - PyObject_GetDictPtr
  50:     0x7ffc5f0da323 - PyObject_IsTrue
  51:     0x7ffc5f15ccf0 - PyDict_Clear
  52:     0x7ffc5f15cc10 - PyDict_Clear
  53:     0x7ffc5f15b665 - PyObject_IsAbstract
  54:     0x7ffc5f15c89a - PyUnicode_DecodeUTF32Stateful
  55:     0x7ffc5f1049e1 - PyModule_GetNameObject
  56:     0x7ffc5f19b298 - Py_GetLocaleEncoding
  57:     0x7ffc5f19b1ef - Py_GetLocaleEncoding
  58:     0x7ffc5f1a7d7d - Py_FinalizeEx
  59:     0x7ffc5f1438c6 - Py_RunMain
  60:     0x7ffc5f1432d9 - Py_Main
  61:     0x7ff727961230 - <unknown>
  62:     0x7ffce0cae8d7 - BaseThreadInitThunk
  63:     0x7ffce1fac53c - RtlUserThreadStart
Unhandled exception caught in c10/util/AbortHandler.h
00007FFBCE219BE6 <unknown symbol address> torch_python.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFCDF2319D7 <unknown symbol address> ucrtbase.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFCC2B22444 <unknown symbol address> VCRUNTIME140.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFCC2B30684 <unknown symbol address> VCRUNTIME140.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFCC2B2ECD0 <unknown symbol address> VCRUNTIME140.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFCE208632F <unknown symbol address> ntdll.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFCE1F32327 <unknown symbol address> ntdll.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFCE1F2A961 <unknown symbol address> ntdll.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFCDF9B804A <unknown symbol address> KERNELBASE.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFCC2B26480 <unknown symbol address> VCRUNTIME140.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC3F4A11ED <unknown symbol address> tracea.pyd!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC3F4A10C5 <unknown symbol address> tracea.pyd!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC3F494A35 <unknown symbol address> tracea.pyd!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC3F49D883 <unknown symbol address> tracea.pyd!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC3F49D5D9 <unknown symbol address> tracea.pyd!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC3F49B86F <unknown symbol address> tracea.pyd!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC3F494D4E <unknown symbol address> tracea.pyd!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC3F4B4AC1 <unknown symbol address> tracea.pyd!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC3F4B4750 <unknown symbol address> tracea.pyd!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC3F45FC14 <unknown symbol address> tracea.pyd!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC3F45F48B <unknown symbol address> tracea.pyd!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC3F45F8A2 <unknown symbol address> tracea.pyd!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC3F45F41D <unknown symbol address> tracea.pyd!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFCC2B21030 <unknown symbol address> VCRUNTIME140.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFCC2B24CB2 <unknown symbol address> VCRUNTIME140.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFCC2B2F0E4 <unknown symbol address> VCRUNTIME140.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFCC2B23F28 <unknown symbol address> VCRUNTIME140.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFCC2B2FA21 <unknown symbol address> VCRUNTIME140.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFCE20863AF <unknown symbol address> ntdll.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFCE1F2E593 <unknown symbol address> ntdll.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFCC2B2F5AE <unknown symbol address> VCRUNTIME140.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFCC2B22BF5 <unknown symbol address> VCRUNTIME140.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFCC2B2300D <unknown symbol address> VCRUNTIME140.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFCC2B24024 <unknown symbol address> VCRUNTIME140.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFCC2B2FA21 <unknown symbol address> VCRUNTIME140.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFCE208632F <unknown symbol address> ntdll.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFCE1F32327 <unknown symbol address> ntdll.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFCE1F2A961 <unknown symbol address> ntdll.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFCDF9B804A <unknown symbol address> KERNELBASE.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFCC2B26480 <unknown symbol address> VCRUNTIME140.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC3F4A11ED <unknown symbol address> tracea.pyd!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC3F4A10C5 <unknown symbol address> tracea.pyd!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC3F494A35 <unknown symbol address> tracea.pyd!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC3F49D883 <unknown symbol address> tracea.pyd!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC3F49D5D9 <unknown symbol address> tracea.pyd!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC3F49B86F <unknown symbol address> tracea.pyd!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC3F494D4E <unknown symbol address> tracea.pyd!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC3F4B4AC1 <unknown symbol address> tracea.pyd!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC3F4B4750 <unknown symbol address> tracea.pyd!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC3F45FC14 <unknown symbol address> tracea.pyd!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC3F45F48B <unknown symbol address> tracea.pyd!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC3F45F8A2 <unknown symbol address> tracea.pyd!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC3F45F326 <unknown symbol address> tracea.pyd!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC3F45F151 <unknown symbol address> tracea.pyd!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC3F45EA0F <unknown symbol address> tracea.pyd!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC3F45ECD1 <unknown symbol address> tracea.pyd!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC5F0DBC9E <unknown symbol address> python310.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC5F0DA323 <unknown symbol address> python310.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC5F15CCF0 <unknown symbol address> python310.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC5F15CC10 <unknown symbol address> python310.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC5F15B665 <unknown symbol address> python310.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC5F15C89A <unknown symbol address> python310.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC5F1049E1 <unknown symbol address> python310.dll!<unknown symbol> [<unknown file> @ <unknown line number>]
00007FFC5F19B298 <unknown symbol address> python310.dll!<unknown symbol> [<unknown file> @ <unknown line number>]

